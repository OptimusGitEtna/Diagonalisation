{% extends "EtnaMathsBundle:Layout:main_layout.html.twig" %}

{% block body -%}
    <section id="container" class="">
    <section id="main-content">
        <section class="wrapper site-min-height">
            <!-- page start-->
            <section class="panel">
                <header class="panel-heading">
                    Calcul du polynome caracteristique.
                </header>
                <div class="panel-body">
                    <div class="adv-table editable-table ">
                        
                        <div class="space15"></div>
                        <table class="table table-striped table-hover table-bordered" id="editable-sample">
                            
                            <tr>
                               <td><input type="text" id="a1" name="a1"/></td>
                               <td><input type="text" id="a2" name="a2"/></td>
                               <td><input type="text" id="a3" name="a3"/></td>
                            </tr>
                            <tr>
                               <td><input type="text" id="b1" name="b1"/></td>
                               <td><input type="text" id="b2" name="b2"/></td>
                               <td><input type="text" id="b3" name="b3"/></td>
                            </tr>
                            <tr>
                               <td><input type="text" id="c1" name="c1"/></td>
                               <td><input type="text" id="c2" name="c2"/></td>
                               <td><input type="text" id="c3" name="c3"/></td>
                            </tr>
                        </table>
                    </div>
                </div>
               <button id="resultat-btn">Lancer le calcul</button>
               <div>Calcul du polynome caracteristique : <span id="resultat"></span></div>
            </section>
            <!-- page end-->
        </section>
    </section>
    <!--main content end-->
    <!--footer start-->
    <footer class="site-footer">
        <div class="text-center">
            Etna promo -  2015
            <a href="#" class="go-top">
                <i class="fa fa-angle-up"></i>
            </a>
        </div>
    </footer>
    <!--footer end-->
    </section>

{% endblock %}
{%  block javascripts %}
    {{ parent() }}
        <script>
            jQuery(document).ready(function() {
                  
                    $('#resultat-btn').on('click', function(e) {
                       //var coeff1 = $('#a1').val();
                       var a1, a2, a3, b1, b2, b3, c1, c2, c3;
                       var aCoefficient = [
                          $('#a1').val(),
                          $('#a2').val(),
                          $('#a3').val(),
                          $('#b1').val(),
                          $('#b2').val(),
                          $('#b3').val(),
                          $('#c1').val(),
                          $('#c2').val(),
                          $('#c3').val()
                       ];
                       
                       alert("affiche coefficient 9 "+aCoefficient[0]);
                       $.ajax({
                        type: "POST",
                        url: "{{ path('init_matrice') }}",
                        data: { aCoefficient: aCoefficient }
                        })
                        .done(function( result ) {
                            console.log('coucou raw');
                            });
                     });

                $('tbody').on('click', '.add',function(e) {

                    var x3 = $(this).closest('tr').find('.x0 input').val();
                    var x0 = $(this).closest('tr').find('.x3 input').val();
                    var x1 = $(this).closest('tr').find('.x2 input').val();
                    var x2 = $(this).closest('tr').find('.x1 input').val();
                    var polyname = $(this).closest('tr').find('.polyname').val();

                    console.log('check les results:'+x3+''+x2+''+x1+''+x0+''+polyname);
                    //console.log($('.field'));

                    $('.field').each(function(index){
                        console.log($(this));
                        $(this).replaceWith(($(this).val()));
                        // $(this).closest('tr').replaceWith($('<td class="x'+index+'"><input type="text" class="field" style="width: 50px;" value="'+ $.trim(this.innerHTML)+'" /></td>'));
                    });

                    console.log($('.action-field').html());
                    $('.action-field').replaceWith('<td class="action-col"><div class="edit btn btn-success btn-xs center"><i class=" fa fa-pencil"></i></div> <div class="cancel btn btn-danger btn-xs center"><i class="fa fa-chain-broken"></i></div> <div class="play btn btn-info btn-xs center">=</div> <div class="save btn btn-warning btn-xs center"><i class="fa fa-save"></i></div> <div class="del btn btn-danger btn-xs center"><i class="fa fa-trash-o"></i></div></td>');
                    $.ajax({
                        type: "POST",
                        url: "{{ path('add_polynome_raw') }}",
                        data: { polyname: polyname, x3: x3, x2: x2, x1: x1, x0: x0 }
                    })
                    .done(function( result ) {
                        console.log('coucou raw');
                        });
                    });

                    $('.del').on('click', function(e) {
                        var polyname = $(this).closest('tr').find('.polyname').text();
                        var x1 = $(this).closest('tr').find('.x3').text();
                        var x2 = $(this).closest('tr').find('.x2').text();
                        var x3 = $(this).closest('tr').find('.x1').text();
                        var x0 = $(this).closest('tr').find('.x0').text();

                        $(this).closest('tr').remove();

                        $.ajax({
                            type: "DELETE",
                            url: "{{ path('delete_polynome_raw') }}",
                            data: { x3: x3, x2: x2, x1: x1, x0: x0, polyname: polyname }
                        })
                                .done(function(result) {
                                    //alert ("FAIRE POPIN DE CONFIRMATION DE SUPPRESSION");
                                });
                    });
            });
        </script>
{% endblock javascripts %}
